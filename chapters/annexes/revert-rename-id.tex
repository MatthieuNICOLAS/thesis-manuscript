\Annex{Algorithmes \textsc{revertRenameId}}
\label{app:revert-rename-id}

\autoref{alg:appendix-revert-rename-id} features the remaining functions composing \textsc{revertRenameId}.
\textsc{revRenIdLessThanNewFirstId} (resp. \textsc{revRenIdGreaterThanNewLastId}) enables to revert the effects of a previously applied \emph{rename} operation on identifiers with $\trm{id}$ such as $\trm{id} < \trm{newFirstId}$ (resp. $\trm{newLastId}$ < $\trm{id}$).

\begin{algorithm}[!ht]
  \footnotesize
  \begin{algorithmic}[1]
      \Function{revRenIdLessThanNewFirstId}{id $\in \mathbb{I}$, firstId $\in \mathbb{I}$, newFirstId $\in \mathbb{I}$}{: $\mathbb{I}$}
        \Statex \Comment $\text{newFirstId} = \newFirstId$
        \Statex \Comment $\text{predNewFirstId} = \predNewFirstId$

          \If{$\text{id} = \text{predNewId} \oplus \text{tail}$}
              \If{$\text{tail} \lid \text{firstId}$}
                  \State \Return tail
              \Else
                  \Statex \Comment id has been inserted causally after the \emph{rename} op
                  \Statex \Comment $\text{firstId} = \text{prefix} \oplus \logootsplituple{n}$

                  \State $\text{predFirstId} \gets \text{prefix} \oplus \langle \text{pos}_n,\text{nodeId}_n,\text{nodeSeq}_n,\text{offset}_n - 1 \rangle$
                  \State \Return $\text{predFirstId} \oplus \topt \oplus tail$
              \EndIf
          \Else
              \State \Return id
          \EndIf
      \EndFunction
      \\
      \Function{revRenIdGreaterThanNewLastId}{id $\in \mathbb{I}$, lastId $\in \mathbb{I}$}{: $\mathbb{I}$}
          \If{$\text{id} \lid \text{lastId}$}
              \Statex \Comment id has been inserted causally after the \emph{rename} op
              \State \Return $\text{lastId} \oplus \bott \oplus \text{id}$
          \ElsIf{$\text{id} = \text{newLastId} \oplus \text{tail}$}
              \If{$\text{tail} \lid \text{lastId}$}
                  \Statex \Comment id has been inserted causally after the \emph{rename} op
                  \State \Return $\text{lastId} \oplus \bott \oplus \text{tail}$
              \ElsIf{$\text{tail} \lid \text{newLastId}$}
                  \State \Return tail
              \Else
                  \Statex \Comment id has been inserted causally after the \emph{rename} op
                  \State \Return id
              \EndIf
          \Else
              \State \Return id
          \EndIf
      \EndFunction
  \end{algorithmic}
  \caption{Remaining functions to revert an identifier renaming}
  \label{alg:appendix-revert-rename-id}
\end{algorithm}

Like \textsc{renIdLessThanFirstId} and \textsc{renIdGreaterThanFirstId}, these functions do not modify identifiers out of the range of renamed identifiers and of resulting identifiers.
%
To process other cases, the functions study the pattern of the given identifier.
If \textsc{revRenIdLessThanNewFirstId} (resp. \textsc{revRenIdGreaterThanNewLastId}) infers from the value of the identifier that it may come from a concurrent \emph{insert} operation to the \emph{rename} one, \textsc{revRenIdLessThanNewFirstId} (resp. \textsc{revRenIdGreaterThanNewLastId}) simply removes the prefix added by \textsc{renIdLessThanFirstId} (resp. \textsc{renIdGreaterThanLastId}).
%
If the value of an identifier instead indicates that it was inserted causally after the \emph{rename} operation, \textsc{revRenIdLessThanNewFirstId} (resp. \textsc{revRenIdGreaterThanNewLastId}) generates a corresponding identifier at the parent epoch preserving the intended order using $\trm{predFirstId}$ and $\trm{MAX\_TUPLE}$ (resp. $\trm{lastId}$ and $\trm{MIN\_TUPLE}$).
